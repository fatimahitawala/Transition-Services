paths:
  /admin/move-in/request:
    get:
      summary: Get all move-in requests (Admin)
      description: |
        Retrieves a paginated list of all move-in requests for admin management. 
        Supports comprehensive filtering by status, request type, community/tower, date ranges, and search functionality.
        Security team users can only view approved and closed requests.
      tags: [Admin MoveIn Management]
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: page
          schema:
            type: integer
            default: 1
            minimum: 1
          required: false
          description: Page number for pagination (optional)
        - in: query
          name: per_page
          schema:
            type: integer
            default: 20
            minimum: 1
            maximum: 100
          required: false
          description: Number of items per page (optional)
        - in: query
          name: status
          schema:
            type: string
            enum: [submitted, rfi-pending, rfi-submitted, approved, closed, cancelled]
          required: false
          description: Filter by request status (optional)
        - in: query
          name: requestType
          schema:
            type: string
            enum: [owner, tenant, hho-unit, hhc-company]
          required: false
          description: Filter by request type (optional)
        - in: query
          name: masterCommunityIds
          schema:
            type: string
          required: false
          description: Comma-separated master community IDs for filtering (optional)
          example: "1,2,3"
        - in: query
          name: communityIds
          schema:
            type: string
          required: false
          description: Comma-separated community IDs for filtering (optional)
          example: "1,2,3"
        - in: query
          name: towerIds
          schema:
            type: string
          required: false
          description: Comma-separated tower IDs for filtering (optional)
          example: "1,2,3"
        - in: query
          name: createdStartDate
          schema:
            type: string
            format: date
          required: false
          description: Filter by creation date start (optional)
          example: "2024-01-01"
        - in: query
          name: createdEndDate
          schema:
            type: string
            format: date
          required: false
          description: Filter by creation date end (optional)
          example: "2024-12-31"
        - in: query
          name: moveInStartDate
          schema:
            type: string
            format: date
          required: false
          description: Filter by move-in date start (optional)
          example: "2024-01-01"
        - in: query
          name: moveInEndDate
          schema:
            type: string
            format: date
          required: false
          description: Filter by move-in date end (optional)
          example: "2024-12-31"
        - in: query
          name: search
          schema:
            type: string
          required: false
          description: Search term for filtering across request number, unit number, building name, and community names (optional)
      examples:
        basic_list:
          summary: Basic request list
          description: Get first page of move-in requests
          value:
            page: 1
            per_page: 20
        filtered_list:
          summary: Filtered request list
          description: Get owner requests in submitted status for specific community
          value:
            page: 1
            per_page: 10
            requestType: "owner"
            status: "submitted"
            communityIds: "1,2,3"
        search_list:
          summary: Search request list
          description: Search for requests by unit number or building name
          value:
            page: 1
            per_page: 20
            search: "Tower A"
        date_filtered:
          summary: Date filtered list
          description: Get requests created in specific date range
          value:
            page: 1
            per_page: 20
            createdStartDate: "2025-01-01"
            createdEndDate: "2025-01-31"
      responses:
        '200':
          description: Move-in requests retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Operation completed successfully"
                  code:
                    type: string
                    example: "SC001"
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/MoveInRequest'
                    example:
                      - id: 123
                        moveInRequestNo: "MIR-2025-001234"
                        requestType: "owner"
                        status: "submitted"
                        moveInDate: "2025-09-20"
                        unitNumber: "101"
                        floorNumber: "1"
                        buildingName: "Tower A"
                        masterCommunityName: "Sobha Hartland"
                        communityName: "Hartland 1"
                        towerName: "Tower A"
                        comments: "Owner moving in after renovation"
                        additionalInfo: "Renovation completed"
                        createdAt: "2025-01-15T10:30:00.000Z"
                        updatedAt: "2025-01-15T10:30:00.000Z"
                        createdBy: 789
                        updatedBy: 789
                  pagination:
                    $ref: '#/components/schemas/Pagination'
        '400':
          description: Bad request - validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: "Validation error"
                  code:
                    type: string
                    example: "EC041"
                  data:
                    type: string
                    example: "Invalid query parameters"
        '401':
          description: Unauthorized - authentication required
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: "Please authenticate"
                  code:
                    type: string
                    example: "EC005"
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: "Internal Server Error"
                  code:
                    type: string
                    example: "EC002"

  /admin/move-in/moveInDetails/{requestId}:
    get:
      summary: Get move-in request details by ID
      description: Retrieves detailed information about a specific move-in request
      tags: [Admin MoveIn Management]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: requestId
          required: true
          schema:
            type: integer
            minimum: 1
          description: Move-in request ID
      responses:
        '200':
          description: Move-in request details retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Operation completed successfully"
                  data:
                    $ref: '#/components/schemas/MoveInRequestDetails'
        '400':
          description: Bad request - validation error
        '401':
          description: Unauthorized
        '404':
          description: Request not found
        '500':
          description: Internal server error

  /admin/move-in/owner:
    post:
      summary: Create owner move-in request (Admin)
      description: Create a move-in request on behalf of an owner. All dates must be in ISO 8601 format (YYYY-MM-DD) and moveInDate must be at least 30 days in the future.
      tags: [Admin MoveIn Management]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [unitId, moveInDate, details]
              properties:
                unitId:
                  type: integer
                  description: ID of the unit for move-in
                  example: 7
                moveInDate:
                  type: string
                  format: date
                  description: Move-in date in ISO 8601 format (YYYY-MM-DD). Must be at least 30 days in the future.
                  example: "2025-09-17"
                  pattern: '^\d{4}-\d{2}-\d{2}$'
                details:
                  type: object
                  required: [adults, children, householdStaffs, pets]
                  properties:
                    adults:
                      type: integer
                      minimum: 1
                      maximum: 6
                      description: Number of adults (1-6)
                      example: 1
                    children:
                      type: integer
                      minimum: 0
                      maximum: 6
                      description: Number of children (0-6)
                      example: 0
                    householdStaffs:
                      type: integer
                      minimum: 0
                      maximum: 4
                      description: Number of household staff (0-4)
                      example: 0
                    pets:
                      type: integer
                      minimum: 0
                      maximum: 6
                      description: Number of pets (0-6)
                      example: 0
                    peopleOfDetermination:
                      type: boolean
                      description: Whether any occupants have special needs
                      example: false
                    detailsText:
                      type: string
                      description: Details about special needs assistance (required when peopleOfDetermination is true)
                      example: "Need wheelchair assistance for elderly or people of determination during move-in"
            examples:
              without_special_needs:
                summary: Owner move-in without special needs
                value:
                  unitId: 7
                  moveInDate: "2025-09-17"
                  details:
                    adults: 1
                    children: 0
                    householdStaffs: 0
                    pets: 0
                    peopleOfDetermination: false
              with_special_needs:
                summary: Owner move-in with special needs
                value:
                  unitId: 7
                  moveInDate: "2025-09-17"
                  details:
                    adults: 2
                    children: 1
                    householdStaffs: 1
                    pets: 1
                    peopleOfDetermination: true
                    detailsText: "Need wheelchair assistance for elderly or people of determination during move-in"
      responses:
        '201':
          description: Owner move-in request created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Owner move-in request created successfully"
                  data:
                    $ref: '#/components/schemas/MoveInRequest'
        '400':
          description: Bad request - validation error
        '401':
          description: Unauthorized
        '403':
          description: Forbidden - admin access required
        '500':
          description: Internal server error

  /admin/move-in/tenant:
    post:
      summary: Create tenant move-in request (Admin)
      description: Create a new move-in request for a tenant. All dates must be in ISO 8601 format (YYYY-MM-DD) and moveInDate must be at least 30 days in the future.
      tags: [Admin MoveIn Management]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - unitId
                - moveInDate
                - firstName
                - lastName
                - email
                - dialCode
                - phoneNumber
                - nationality
                - emiratesIdNumber
                - emiratesIdExpiryDate
                - tenancyContractStartDate
                - tenancyContractEndDate
                - details
              properties:
                unitId:
                  type: integer
                  description: ID of the unit for move-in
                  example: 123
                moveInDate:
                  type: string
                  format: date
                  description: Move-in date in ISO 8601 format (YYYY-MM-DD). Must be at least 30 days in the future.
                  example: "2025-12-20"
                  pattern: '^\d{4}-\d{2}-\d{2}$'
                firstName:
                  type: string
                  maxLength: 100
                  description: Tenant's first name
                  example: "John"
                lastName:
                  type: string
                  maxLength: 100
                  description: Tenant's last name
                  example: "Doe"
                email:
                  type: string
                  format: email
                  maxLength: 255
                  description: Tenant's email address
                  example: "john.doe@example.com"
                dialCode:
                  type: string
                  maxLength: 10
                  description: Country dial code
                  example: "+971"
                phoneNumber:
                  type: string
                  maxLength: 20
                  description: Phone number
                  example: "501234567"
                nationality:
                  type: string
                  maxLength: 100
                  description: Tenant's nationality
                  example: "UAE"
                emiratesIdNumber:
                  type: string
                  description: Emirates ID number
                  example: "784-1985-1234567-8"
                emiratesIdExpiryDate:
                  type: string
                  format: date
                  description: Emirates ID expiry date in ISO 8601 format (YYYY-MM-DD)
                  example: "2026-12-31"
                  pattern: '^\d{4}-\d{2}-\d{2}$'
                tenancyContractStartDate:
                  type: string
                  format: date
                  description: Tenancy contract start date in ISO 8601 format (YYYY-MM-DD)
                  example: "2025-09-01"
                  pattern: '^\d{4}-\d{2}-\d{2}$'
                tenancyContractEndDate:
                  type: string
                  format: date
                  description: Tenancy contract end date in ISO 8601 format (YYYY-MM-DD). Must be after tenancyContractStartDate.
                  example: "2026-08-31"
                  pattern: '^\d{4}-\d{2}-\d{2}$'
                comments:
                  type: string
                  nullable: true
                  description: Additional comments for the move-in request
                  example: "Need early access for furniture delivery"
                additionalInfo:
                  type: string
                  nullable: true
                  description: Additional information
                  example: ""
                details:
                  type: object
                  required:
                    - adults
                    - children
                    - householdStaffs
                    - pets
                    - peopleOfDetermination
                    - termsAccepted
                  properties:
                    adults:
                      type: integer
                      minimum: 1
                      maximum: 6
                      description: Number of adults (1-6)
                      example: 2
                    children:
                      type: integer
                      minimum: 0
                      maximum: 6
                      description: Number of children (0-6)
                      example: 1
                    householdStaffs:
                      type: integer
                      minimum: 0
                      maximum: 4
                      description: Number of household staff (0-4)
                      example: 1
                    pets:
                      type: integer
                      minimum: 0
                      maximum: 6
                      description: Number of pets (0-6)
                      example: 1
                    peopleOfDetermination:
                      type: boolean
                      description: Whether any occupants have special needs
                      example: true
                    termsAccepted:
                      type: boolean
                      enum: [true]
                      description: Must be true to accept terms and conditions
                      example: true
                    detailsText:
                      type: string
                      description: Details about special needs assistance (required when peopleOfDetermination is true)
                      example: "Need wheelchair assistance for elderly or people of determination during move-in"
            examples:
              without_special_needs:
                summary: Tenant move-in without special needs
                value:
                  unitId: 123
                  moveInDate: "2025-12-20"
                  firstName: "John"
                  lastName: "Doe"
                  email: "john.doe@example.com"
                  dialCode: "+971"
                  phoneNumber: "501234567"
                  nationality: "UAE"
                  emiratesIdNumber: "784-1985-1234567-8"
                  emiratesIdExpiryDate: "2026-12-31"
                  tenancyContractStartDate: "2025-09-01"
                  tenancyContractEndDate: "2026-08-31"
                  comments: "Need early access for furniture delivery"
                  additionalInfo: ""
                  details:
                    adults: 2
                    children: 1
                    householdStaffs: 0
                    pets: 1
                    peopleOfDetermination: false
                    termsAccepted: true
              with_special_needs:
                summary: Tenant move-in with special needs
                value:
                  unitId: 123
                  moveInDate: "2025-12-20"
                  firstName: "John"
                  lastName: "Doe"
                  email: "john.doe@example.com"
                  dialCode: "+971"
                  phoneNumber: "501234567"
                  nationality: "UAE"
                  emiratesIdNumber: "784-1985-1234567-8"
                  emiratesIdExpiryDate: "2026-12-31"
                  tenancyContractStartDate: "2025-09-01"
                  tenancyContractEndDate: "2026-08-31"
                  comments: "Need early access for furniture delivery"
                  additionalInfo: ""
                  details:
                    adults: 2
                    children: 1
                    householdStaffs: 1
                    pets: 1
                    peopleOfDetermination: true
                    termsAccepted: true
                    detailsText: "Need wheelchair assistance for elderly or people of determination during move-in"
      responses:
        '201':
          description: Tenant move-in request created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Tenant move-in request created successfully"
                  data:
                    $ref: '#/components/schemas/MoveInRequest'
        '400':
          description: Bad request - validation error
        '401':
          description: Unauthorized
        '403':
          description: Forbidden - admin access required
        '500':
          description: Internal server error

  /admin/move-in/hho-unit:
    post:
      summary: Create HHO Unit move-in request (Admin)
      description: Create a move-in request on behalf of a Holiday Home Unit Owner
      tags: [Admin MoveIn Management]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [unitId, moveInDate, details]
              properties:
                unitId:
                  type: integer
                  description: ID of the unit for move-in
                  example: 123
                moveInDate:
                  type: string
                  format: date
                  description: Move-in date (at least 30 days in the future)
                  example: "2025-08-28"
                ownerFirstName:
                  type: string
                  maxLength: 100
                  description: Owner first name (optional; derived from auth user if omitted)
                  example: "John"
                ownerLastName:
                  type: string
                  maxLength: 100
                  description: Owner last name (optional; derived from auth user if omitted)
                  example: "Doe"
                email:
                  type: string
                  format: email
                  maxLength: 255
                  description: Owner email address (optional; derived from auth user if omitted)
                  example: "john.doe@example.com"
                dialCode:
                  type: string
                  maxLength: 10
                  description: Phone country dial code (optional; derived from auth user if omitted)
                  example: "+971"
                phoneNumber:
                  type: string
                  maxLength: 20
                  description: Owner phone number (optional; derived from auth user if omitted)
                  example: "501234567"
                nationality:
                  type: string
                  maxLength: 100
                  description: Owner nationality (optional; derived from auth user if omitted)
                  example: "UAE"
                comments:
                  type: string
                  nullable: true
                  description: Additional comments
                  example: "HHO unit owner moving in"
                additionalInfo:
                  type: string
                  nullable: true
                  description: Additional information
                  example: "Unit permit verified"
                details:
                  type: object
                  required: [unitPermitNumber, unitPermitStartDate, unitPermitExpiryDate, termsAccepted]
                  properties:
                    unitPermitNumber:
                      type: string
                      description: Unit permit number
                      example: "42388"
                    unitPermitStartDate:
                      type: string
                      format: date
                      description: Unit permit start date
                      example: "2027-08-27"
                    unitPermitExpiryDate:
                      type: string
                      format: date
                      description: Unit permit expiry date
                      example: "2028-08-27"
                    termsAccepted:
                      type: boolean
                      enum: [true]
                      description: Terms and conditions acceptance
                      example: true
      responses:
        '201':
          description: HHO Unit move-in request created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "HHO Unit move-in request created successfully"
                  data:
                    $ref: '#/components/schemas/MoveInRequest'
        '400':
          description: Bad request - validation error
        '401':
          description: Unauthorized
        '403':
          description: Forbidden - admin access required
        '500':
          description: Internal server error

  /admin/move-in/hhc-company:
    post:
      summary: Create HHC Company move-in request (Admin)
      description: Create a move-in request on behalf of an HHC Company. All dates must be in ISO 8601 format (YYYY-MM-DD) and moveInDate must be at least 30 days in the future.
      tags: [Admin MoveIn Management]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - unitId
                - moveInDate
                - userEmail
                - firstName
                - lastName
                - mobileNumber
                - name
                - company
                - companyEmail
                - operatorOfficeNumber
                - tradeLicenseNumber
                - tradeLicenseExpiryDate
                - nationality
                - emiratesIdNumber
                - emiratesIdExpiryDate
                - tenancyContractStartDate
                - unitPermitStartDate
                - unitPermitExpiryDate
                - unitPermitNumber
                - leaseStartDate
                - leaseEndDate
                - dtcmStartDate
                - dtcmExpiryDate
                - details
              properties:
                unitId:
                  type: integer
                  description: ID of the unit for move-in
                  example: 123
                moveInDate:
                  type: string
                  format: date
                  description: Move-in date in ISO 8601 format (YYYY-MM-DD). Must be at least 30 days in the future.
                  example: "2025-09-20"
                  pattern: '^\d{4}-\d{2}-\d{2}$'
                userEmail:
                  type: string
                  format: email
                  description: User email address
                  example: "essa.mohammed@gmail.com"
                firstName:
                  type: string
                  description: User first name
                  example: "Essa"
                middleName:
                  type: string
                  nullable: true
                  description: User middle name (optional)
                  example: "Mohammed"
                lastName:
                  type: string
                  description: User last name
                  example: "Mohammed"
                mobileNumber:
                  type: string
                  description: User mobile number
                  example: "0555 0898XX"
                name:
                  type: string
                  description: Company representative name
                  example: "Essa"
                company:
                  type: string
                  description: Company name
                  example: "ABC Company"
                companyEmail:
                  type: string
                  format: email
                  description: Company email address
                  example: "abccompany@gmail.com"
                countryCode:
                  type: string
                  description: Country code for phone number
                  example: "+971"
                operatorOfficeNumber:
                  type: string
                  description: Office contact number
                  example: "+971 122345678"
                tradeLicenseNumber:
                  type: string
                  description: Trade license number
                  example: "12345678"
                tradeLicenseExpiryDate:
                  type: string
                  format: date
                  description: Trade license expiry date (YYYY-MM-DD)
                  example: "2026-12-31"
                nationality:
                  type: string
                  description: Representative nationality
                  example: "United Arab Emirates"
                emiratesIdNumber:
                  type: string
                  description: Emirates ID number
                  example: "12345678"
                emiratesIdExpiryDate:
                  type: string
                  format: date
                  description: Emirates ID expiry date (YYYY-MM-DD)
                  example: "2030-05-15"
                tenancyContractStartDate:
                  type: string
                  format: date
                  description: Tenancy contract start date (YYYY-MM-DD)
                  example: "2025-09-01"
                unitPermitStartDate:
                  type: string
                  format: date
                  description: Unit permit start date (YYYY-MM-DD)
                  example: "2025-09-20"
                unitPermitExpiryDate:
                  type: string
                  format: date
                  description: Unit permit expiry date (YYYY-MM-DD) - must be after start date
                  example: "2026-09-20"
                unitPermitNumber:
                  type: string
                  description: Unit permit number
                  example: "42388"
                leaseStartDate:
                  type: string
                  format: date
                  description: Lease start date (YYYY-MM-DD)
                  example: "2025-09-20"
                leaseEndDate:
                  type: string
                  format: date
                  description: Lease end date (YYYY-MM-DD) - must be after start date
                  example: "2026-09-20"
                dtcmStartDate:
                  type: string
                  format: date
                  description: DTCM start date (YYYY-MM-DD)
                  example: "2025-09-01"
                dtcmExpiryDate:
                  type: string
                  format: date
                  description: DTCM expiry date (YYYY-MM-DD) - must be after start date
                  example: "2027-12-31"
                comments:
                  type: string
                  nullable: true
                  description: Additional comments
                additionalInfo:
                  type: string
                  nullable: true
                  description: Additional information
                details:
                  type: object
                  required: [termsAccepted]
                  properties:
                    termsAccepted:
                      type: boolean
                      enum: [true]
                      example: true
                      description: Must be true to accept terms and conditions
      responses:
        '201':
          description: HHC Company move-in request created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "HHC Company move-in request created successfully"
                  data:
                    $ref: '#/components/schemas/MoveInRequest'
        '400':
          description: Bad request - validation error
        '401':
          description: Unauthorized
        '403':
          description: Forbidden - admin access required
        '500':
          description: Internal server error

  /admin/move-in/request/{requestId}/documents:
    post:
      summary: Upload documents for move-in request
      description: Upload required documents for a move-in request
      tags: [Admin MoveIn Management]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: requestId
          required: true
          schema:
            type: integer
            minimum: 1
          description: Move-in request ID
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                emiratesIdFront:
                  type: string
                  format: binary
                  description: Emirates ID front side
                emiratesIdBack:
                  type: string
                  format: binary
                  description: Emirates ID back side
                ejari:
                  type: string
                  format: binary
                  description: Ejari contract document
                unitPermit:
                  type: string
                  format: binary
                  description: Unit permit document
                companyTradeLicense:
                  type: string
                  format: binary
                  description: Company trade license
                titleDeed:
                  type: string
                  format: binary
                  description: Title deed document
                other:
                  type: string
                  format: binary
                  description: Other supporting documents (max 4)
      responses:
        '200':
          description: Documents uploaded successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Documents uploaded successfully"
                  data:
                    type: object
                    properties:
                      requestId:
                        type: integer
                        example: 123
                      uploadedDocuments:
                        type: array
                        items:
                          type: object
                          properties:
                            documentType:
                              type: string
                              example: "emiratesIdFront"
                            fileName:
                              type: string
                              example: "emirates_id_front.pdf"
                            fileUrl:
                              type: string
                              example: "https://storage.blob.core.windows.net/documents/emirates_id_front.pdf"
        '400':
          description: Bad request - validation error
        '401':
          description: Unauthorized
        '404':
          description: Request not found
        '500':
          description: Internal server error

  /admin/move-in/request/{requestId}/approve:
    put:
      summary: Approve move-in request
      description: Approve a move-in request that has been submitted or resubmitted after RFI
      tags: [Admin MoveIn Management]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: requestId
          required: true
          schema:
            type: integer
            minimum: 1
          description: The ID of the move-in request to approve
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [comments]
              properties:
                comments:
                  type: string
                  maxLength: 35
                  description: Approval comments/remarks
                  example: "All documents verified and requirements met. Approved for move-in."
      responses:
        '200':
          description: Move-in request approved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Move-in request approved successfully"
                  data:
                    type: object
                    properties:
                      requestId:
                        type: integer
                        example: 123
                      status:
                        type: string
                        example: "approved"
                      moveInPermitUrl:
                        type: string
                        example: "move-in-permit-123.pdf"
        '400':
          description: Bad request - validation error
        '401':
          description: Unauthorized
        '404':
          description: Request not found
        '500':
          description: Internal server error

  /admin/move-in/request/{requestId}/rfi:
    put:
      summary: Mark move-in request as RFI
      description: Mark a move-in request as Request for Information when additional details are needed
      tags: [Admin MoveIn Management]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: requestId
          required: true
          schema:
            type: integer
            minimum: 1
          description: The ID of the move-in request to mark as RFI
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [comments]
              properties:
                comments:
                  type: string
                  maxLength: 35
                  description: RFI comments/remarks explaining what additional information is needed
                  example: "Please provide updated Emirates ID with extended validity period."
      responses:
        '200':
          description: Request marked as RFI successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Request marked as RFI successfully"
                  data:
                    type: object
                    properties:
                      requestId:
                        type: integer
                        example: 123
                      status:
                        type: string
                        example: "rfi-pending"
        '400':
          description: Bad request - validation error
        '401':
          description: Unauthorized
        '404':
          description: Request not found
        '500':
          description: Internal server error

  /admin/move-in/request/{requestId}/cancel:
    put:
      summary: Cancel/Reject move-in request
      description: Cancel or reject a move-in request that is invalid, duplicated, or unqualified
      tags: [Admin MoveIn Management]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: requestId
          required: true
          schema:
            type: integer
            minimum: 1
          description: The ID of the move-in request to cancel
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [cancellationRemarks]
              properties:
                cancellationRemarks:
                  type: string
                  maxLength: 100
                  description: Detailed explanation for cancellation/rejection
                  example: "Request cancelled due to duplicate submission for the same unit and date range."
      responses:
        '200':
          description: Request cancelled successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Request cancelled successfully"
                  data:
                    type: object
                    properties:
                      requestId:
                        type: integer
                        example: 123
                      status:
                        type: string
                        example: "cancelled"
        '400':
          description: Bad request - validation error
        '401':
          description: Unauthorized
        '404':
          description: Request not found
        '500':
          description: Internal server error

  /admin/move-in/request/{requestId}/close:
    put:
      summary: Close move-in request by security
      description: Close an approved move-in request when the customer arrives at the site
      tags: [Admin MoveIn Management]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: requestId
          required: true
          schema:
            type: integer
            minimum: 1
          description: The ID of the approved move-in request to close
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [closureRemarks, actualMoveInDate]
              properties:
                closureRemarks:
                  type: string
                  maxLength: 100
                  description: Security remarks about the closure
                  example: "Customer arrived with valid MIP. Unit access granted and keys handed over."
                actualMoveInDate:
                  type: string
                  format: date
                  description: Actual date when the customer moved in
                  example: "2025-01-15"
      responses:
        '200':
          description: Request closed successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Request closed successfully"
                  data:
                    type: object
                    properties:
                      requestId:
                        type: integer
                        example: 123
                      status:
                        type: string
                        example: "closed"
                      actualMoveInDate:
                        type: string
                        format: date
                        example: "2025-01-15"
        '400':
          description: Bad request - validation error
        '401':
          description: Unauthorized
        '404':
          description: Request not found
        '500':
          description: Internal server error

  /admin/move-in/status-flow:
    get:
      summary: Get status transition flow
      description: Retrieve the status transition flow and business rules for move-in request management
      tags: [Admin MoveIn Management]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Status transition flow retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  statusFlow:
                    $ref: '#/components/schemas/StatusTransitionFlow'
                  businessRules:
                    $ref: '#/components/schemas/BusinessRules'
        '401':
          description: Unauthorized
        '500':
          description: Internal server error

components:
  schemas:
    MoveInRequest:
      type: object
      properties:
        id:
          type: integer
          description: Unique identifier for the move-in request
          example: 123
        requestNumber:
          type: string
          description: Auto-generated request number
          example: "MIN-UNIT123-123"
        unitId:
          type: integer
          description: ID of the unit for move-in
          example: 123
        userId:
          type: integer
          description: ID of the user making the request
          example: 456
        userType:
          type: string
          enum: [owner, tenant, hho-unit, hhc-company]
          description: Type of user making the request
          example: "owner"
        moveInDate:
          type: string
          format: date
          description: Requested move-in date
          example: "2025-08-28"
        status:
          type: string
          enum: [submitted, rfi-pending, rfi-submitted, approved, closed, cancelled]
          description: Current status of the request
          example: "submitted"
        comments:
          type: string
          nullable: true
          description: Additional comments
          example: "Owner moving in after renovation"
        additionalInfo:
          type: string
          nullable: true
          description: Additional information
          example: "Renovation completed"
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2025-01-15T10:30:00.000Z"
        updatedAt:
          type: string
          format: date-time
          description: Last update timestamp
          example: "2025-01-15T10:30:00.000Z"
        createdBy:
          type: integer
          description: ID of the user who created the request
          example: 789
        updatedBy:
          type: integer
          description: ID of the user who last updated the request
          example: 789
        moveInRequestNo:
          type: string
          description: Move-in request number
          example: "MIR-2025-001234"
        requestType:
          type: string
          enum: [owner, tenant, hho-unit, hhc-company]
          description: Type of move-in request
          example: "owner"
        unitNumber:
          type: string
          description: Unit number
          example: "101"
        floorNumber:
          type: string
          description: Floor number
          example: "1"
        buildingName:
          type: string
          description: Building name
          example: "Tower A"
        masterCommunityName:
          type: string
          description: Master community name
          example: "Sobha Hartland"
        communityName:
          type: string
          description: Community name
          example: "Hartland 1"
        towerName:
          type: string
          description: Tower name
          example: "Tower A"

    MoveInRequestDetails:
      type: object
      properties:
        id:
          type: integer
          description: Unique identifier for the move-in request
          example: 123
        requestNumber:
          type: string
          description: Auto-generated request number
          example: "MIN-UNIT123-123"
        unitId:
          type: integer
          description: ID of the unit for move-in
          example: 123
        userId:
          type: integer
          description: ID of the user making the request
          example: 456
        userType:
          type: string
          enum: [owner, tenant, hho-unit, hhc-company]
          description: Type of user making the request
          example: "owner"
        moveInDate:
          type: string
          format: date
          description: Requested move-in date
          example: "2025-08-28"
        status:
          type: string
          enum: [submitted, rfi-pending, rfi-submitted, approved, closed, cancelled]
          description: Current status of the request
          example: "submitted"
        comments:
          type: string
          nullable: true
          description: Additional comments
          example: "Owner moving in after renovation"
        additionalInfo:
          type: string
          nullable: true
          description: Additional information
          example: "Renovation completed"
        details:
          type: object
          description: Type-specific details based on userType
          properties:
            titleDeedNumber:
              type: string
              description: Title deed number (for owner)
              example: "TD123456"
            titleDeedDate:
              type: string
              format: date
              description: Title deed date (for owner)
              example: "2020-01-15"
            ejariNumber:
              type: string
              description: Ejari contract number (for tenant)
              example: "EJ123456"
            ejariDate:
              type: string
              format: date
              description: Ejari contract date (for tenant)
              example: "2025-01-15"
            leaseStartDate:
              type: string
              format: date
              description: Lease start date (for tenant/hhc-company)
              example: "2025-02-01"
            leaseEndDate:
              type: string
              format: date
              description: Lease end date (for tenant/hhc-company)
              example: "2027-01-31"
            unitPermitNumber:
              type: string
              description: Unit permit number (for hho-unit)
              example: "42388"
            unitPermitStartDate:
              type: string
              format: date
              description: Unit permit start date (for hho-unit)
              example: "2027-08-27"
            unitPermitExpiryDate:
              type: string
              format: date
              description: Unit permit expiry date (for hho-unit)
              example: "2028-08-27"
            representativeName:
              type: string
              description: Company representative name (for hhc-company)
              example: "John Smith"
            companyName:
              type: string
              description: Company name (for hhc-company)
              example: "ABC Trading Company LLC"
            companyEmail:
              type: string
              format: email
              description: Company email (for hhc-company)
              example: "info@abctrading.com"
            officeContactNumber:
              type: string
              description: Office contact number (for hhc-company)
              example: "+971501234567"
            tradeLicenseNumber:
              type: string
              description: Trade license number (for hhc-company)
              example: "TL123456"
            tradeLicenseExpiryDate:
              type: string
              format: date
              description: Trade license expiry date (for hhc-company)
              example: "2026-12-31"
            nationality:
              type: string
              description: Nationality (for hhc-company)
              example: "UAE"
            emiratesIdNumber:
              type: string
              description: Emirates ID number (for hhc-company)
              example: "784-1985-1234567-8"
            emiratesIdExpiryDate:
              type: string
              format: date
              description: Emirates ID expiry date (for hhc-company)
              example: "2030-05-15"
            dtcmStartDate:
              type: string
              format: date
              description: DTCM start date (for hhc-company)
              example: "2025-01-01"
            dtcmEndDate:
              type: string
              format: date
              description: DTCM end date (for hhc-company)
              example: "2027-12-31"
            termsAccepted:
              type: boolean
              description: Terms and conditions acceptance
              example: true
        documents:
          type: array
          description: List of uploaded documents
          items:
            type: object
            properties:
              documentType:
                type: string
                description: Type of document
                example: "emiratesIdFront"
              fileName:
                type: string
                description: Name of the uploaded file
                example: "emirates_id_front.pdf"
              fileUrl:
                type: string
                description: URL to access the document
                example: "https://storage.blob.core.windows.net/documents/emirates_id_front.pdf"
              uploadedAt:
                type: string
                format: date-time
                description: When the document was uploaded
                example: "2025-01-15T10:30:00.000Z"
        createdAt:
          type: string
          format: date-time
          description: Creation timestamp
          example: "2025-01-15T10:30:00.000Z"
        updatedAt:
          type: string
          format: date-time
          description: Last update timestamp
          example: "2025-01-15T10:30:00.000Z"
        createdBy:
          type: integer
          description: ID of the user who created the request
          example: 789
        updatedBy:
          type: integer
          description: ID of the user who last updated the request
          example: 789

    StatusTransitionFlow:
      type: object
      description: Status transition flow for move-in requests
      properties:
        submitted:
          type: string
          example: "OPEN (new request submitted)"
        rfiPending:
          type: string
          example: "RFI_PENDING (admin marked as RFI)"
        rfiSubmitted:
          type: string
          example: "RFI_SUBMITTED (customer resubmitted after RFI)"
        approved:
          type: string
          example: "APPROVED (admin approved request)"
        closed:
          type: string
          example: "CLOSED (security closed after physical move-in)"
        cancelled:
          type: string
          example: "CANCELLED (admin cancelled request)"
      required:
        - submitted
        - rfiPending
        - rfiSubmitted
        - approved
        - closed
        - cancelled

    BusinessRules:
      type: object
      description: Business rules for status management
      properties:
        approvalRules:
          type: array
          items:
            type: string
          example: [
            "Only requests in Submitted or RFI Submitted status can be approved",
            "No active overlapping move-in request exists for the same unit",
            "MIP template must be active for the unit",
            "SLA: Move-in request max 30 days validity"
          ]
        rfiRules:
          type: array
          items:
            type: string
          example: [
            "Only requests in Submitted status can be marked as RFI",
            "Admin must provide remarks",
            "Status transition: Submitted  RFI Pending"
          ]
        cancellationRules:
          type: array
          items:
            type: string
          example: [
            "Only requests in Submitted, RFI Submitted, or Approved status can be cancelled",
            "Cancellation remarks are mandatory",
            "Status changes to Cancelled"
          ]
        closureRules:
          type: array
          items:
            type: string
          example: [
            "Only requests in Approved status can be closed",
            "Security team can close requests",
            "Unit is linked to user and marked as occupied",
            "Previous user access is invalidated"
          ]

    Pagination:
      type: object
      properties:
        currentPage:
          type: integer
          example: 1
        totalPages:
          type: integer
          example: 5
        totalItems:
          type: integer
          example: 100
        itemsPerPage:
          type: integer
          example: 20
